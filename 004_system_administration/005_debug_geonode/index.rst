.. _debug_geonode:

===============================
Debugging GeoNode Installations
===============================

There are several mechanisms to debug GeoNode installations, the most common ones are discussed in the following sections.

Viewing the logs
================

There are many kinds of logs in GeoNode, most of them are located in :file:`/var/log/geonode/` and will be explained below in order of relevance:

 * **GeoNode main log**: This is the output of the Django application generated by Apache, it may contain detailed information about uploads and high level problems.

   The default location is :file:`/var/log/geonode/apache.log` or :file:`/var/log/apache2/error.log`.

  It is set to a very low level (not very much information is logged) by default, but it's output can be increased by setting the logging level to ``DEBUG`` in :file:`/etc/geonode/local_settings.py`.

 * **GeoServer log**: It contains most of the information related to problems with data, rendering and styling errors.

   This one can be accessed at ``GEOSERVER_DATA_DIR/logs/geoserver.log``, which is usually :file:`/var/lib/tomcat7/webapps/geoserver/data/logs/geoserver.log` or :file:`/var/lib/geoserver/geonode-data/logs/geoserver.log`.

   It may also be symlinked in :file:`/var/log/geonode/geoserver.log`.

 * **Tomcat logs**: Tomcat logs could indicate problems loading GeoServer.

   They can be found at :file:`/var/lib/tomcat7/logs/catalina.out` or :file:`/var/lib/tomcat/geoserver/logs/catalina.out`.

 * **PostgreSQL logs**: PostgreSQL is accessed by GeoServer and Django, therefore information about errors which are very hard to debug may be found by looking at PostgreSQL's logs.

   They are located at :file:`/var/log/postgresql/postgresql-$(psql_version)-main.log` where **$(psql_version)** depends on your local installation.

Other tips and tricks
=====================

Modifying GeoServer's output strategy
-------------------------------------

Up to version 1.1, GeoNode used by default the ``SPEED`` output strategy of GeoServer, this meant that proper error messages were being sacrificed for performance.
Unfortunately, this caused many errors to be masked as XML parsing errors when layers were not properly configured.

It is recommended to verify the output strategy is set at least to ``PARTIAL_BUFFER2`` **(or a safer one, e.g. ``FILE``)** with a high value for the buffer size.
More information about the different strategies and the performance vs correctness trade off is available at GeoServer's web.xml file.

The typical location of the file that needs to be modified is ``/var/lib/tomcat7/webapps/geoserver/WEB-INF/web.xml`` as shown below::

  <context-param>
    <param-name>serviceStrategy</param-name>
    <param-value>FILE</param-value>
  </context-param>
